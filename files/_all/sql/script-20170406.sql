UPDATE `itreports` SET `SQL_RPT`='Select\n D.Codigo_FAC, DATE_FORMAT(D.Fecha_FAC, \'%d/%m/%Y\'),LPAD(A.Codigo_ADM,10,\'0\'), concat(Q.Sigla_TID,\' \',C.ID_TER), left(C.Nombre_TER, 60), \n J.Descripcion_ADM, E.Codigo_EPS, F.Nombre_TER, concat(\'{\',I.Codigo_USR,\'} \', I.ID_USR), D.ValPaciente_FAC, D.ValEntidad_FAC, D.ValCredito_FAC, D.ValTotal_FAC \nFrom\n czterceros AS C, gxeps AS E, czterceros AS F, cztipoid as Q, \n itusuarios AS I, gxtipoingreso AS J, gxadmision AS A, gxfacturas AS D \nWhere\n A.Codigo_TER = C.Codigo_TER AND Q.Codigo_TID = C.Codigo_TID and D.Codigo_ADM=A.Codigo_ADM\n AND F.Codigo_TER = E.Codigo_TER AND trim(D.Codigo_EPS) = trim(E.Codigo_EPS) \n AND D.Codigo_USR = I.Codigo_USR AND J.Tipo_ADM = A.Ingreso_ADM and D.Estado_FAC=\'1\'\n AND D.Fecha_FAC>=\'@FECHA_INICIAL 00:00:00\' AND D.Fecha_FAC<=\'@FECHA_FINAL 23:59:59\' AND trim(D.Codigo_EPS) = \'@CONTRATO\'\nOrder By\nD.Fecha_FAC, D.Codigo_FAC' WHERE  `Codigo_RPT`='listarfacturasentidad' AND `Codigo_DCD`=0;
ALTER TABLE `gxfacturas`	ADD COLUMN `ValCredito_FAC` DECIMAL(18,2) NOT NULL DEFAULT '0.00' AFTER `ValDcto_FAC`,	ADD COLUMN `ValTotal_FAC` DECIMAL(18,2) NOT NULL DEFAULT '0.00' AFTER `ValCredito_FAC`;
Update gxfacturas set ValTotal_FAC=ValEntidad_FAC -(ValDcto_FAC+ValCredito_FAC);
CREATE TABLE `czconceptonotas` (	`Codigo_CNT` VARCHAR(5) NULL,	`Nombre_CNT` VARCHAR(30) NULL,	`Codigo_CUE` VARCHAR(15) NULL,	`Terceros_CNT` CHAR(1) NULL DEFAULT '0',	`Centros_CNT` CHAR(1) NULL DEFAULT '0') COMMENT='Concepto de Notas' COLLATE='utf8_general_ci' ENGINE=InnoDB;
ALTER TABLE `czconceptonotas`	ALTER `Codigo_CNT` DROP DEFAULT,	ALTER `Codigo_CUE` DROP DEFAULT;
ALTER TABLE `czconceptonotas`	CHANGE COLUMN `Codigo_CNT` `Codigo_CNT` VARCHAR(5) NOT NULL FIRST,	CHANGE COLUMN `Codigo_CUE` `Codigo_CUE` VARCHAR(15) NULL AFTER `Nombre_CNT`,	ADD PRIMARY KEY (`Codigo_CNT`),	ADD INDEX `Codigo_CNT` (`Codigo_CNT`),	ADD INDEX `Codigo_CUE` (`Codigo_CUE`),	ADD INDEX `Nombre_CNT` (`Nombre_CNT`);
INSERT INTO `czconceptonotas` (`Codigo_CNT`, `Nombre_CNT`, `Codigo_CUE`, `Terceros_CNT`) VALUES ('001', 'NC VALOR TOTAL FACTURA', '14090101', '1');
UPDATE `itreports` SET `SQL_RPT`='Select\r\n D.Codigo_FAC, DATE_FORMAT(D.Fecha_FAC, \'%d/%m/%Y\'),LPAD(A.Codigo_ADM,10,\'0\'), concat(Q.Sigla_TID,\' \',C.ID_TER), left(C.Nombre_TER, 60), \r\n J.Descripcion_ADM, E.Codigo_EPS, F.Nombre_TER, concat(\'{\',I.Codigo_USR,\'} \', I.ID_USR), D.ValPaciente_FAC, D.ValEntidad_FAC, K.Codigo_RAD,  DATE_FORMAT(L.FechaConf_RAD, \'%d/%m/%Y\'), D.ValCredito_FAC, D.ValTotal_FAC \r\nFrom\r\n czterceros AS C, gxeps AS E, czterceros AS F, cztipoid as Q, \r\n itusuarios AS I, gxtipoingreso AS J, gxadmision AS A, gxfacturas AS D \r\n left join czradicacionesdet AS K On D.Codigo_FAC=K.Codigo_FAC left join czradicacionescab AS L On L.Codigo_RAD=K.Codigo_RAD\r\nWhere\r\n A.Codigo_TER = C.Codigo_TER AND Q.Codigo_TID = C.Codigo_TID and D.Codigo_ADM=A.Codigo_ADM\r\n AND F.Codigo_TER = E.Codigo_TER AND trim(D.Codigo_EPS) = trim(E.Codigo_EPS) \r\n AND D.Codigo_USR = I.Codigo_USR AND J.Tipo_ADM = A.Ingreso_ADM and D.Estado_FAC=\'1\'\r\n AND D.Fecha_FAC>=\'@FECHA_INICIAL 00:00:00\' AND D.Fecha_FAC<=\'@FECHA_FINAL 23:59:59\'\r\nOrder By\r\nD.Fecha_FAC, D.Codigo_FAC' WHERE  `Codigo_RPT`='listarfacturasfecha' AND `Codigo_DCD`=0;
UPDATE `itreports` SET `SQL_RPT`='Select a.Razonsocial_DCD, a.NIT_DCD, a.Direccion_DCD, a.Telefonos_DCD, a.EncabezadoFact_DCD, a.PiePaginaFact_DCD, \r\n b.ConsecIni_AFC, b.ConsecFin_AFC, b.Resolucion_AFC, b.Fecha_AFC, c.Codigo_FAC, c.Codigo_ADM, c.Fecha_FAC, c.ValPaciente_FAC, \r\n c.ValEntidad_FAC, c.ValDcto_FAC, c.Estado_FAC, CONCAT(e.ID_TER,\'-\',e.DigitoVerif_TER), e.Nombre_TER, e.Direccion_TER, e.Telefono_TER, \r\n LPAD(f.Codigo_ADM,10,\'0\'), CONCAT(h.Sigla_TID,\' \', g.ID_TER), g.Nombre_TER, i.Nombre_PLA, c.Codigo_EPS, c.Codigo_PLA, adddate(c.Fecha_FAC,d.VenceFactura_EPS), c.ValCredito_FAC, c.ValTotal_FAC \r\nFrom itconfig a, czautfacturacion b, gxfacturas c, gxeps d, czterceros e, gxadmision f, czterceros g, cztipoid h, gxplanes i\r\nWhere a.Codigo_AFC = b.Codigo_AFC and b.Estado_AFC=\'1\' and d.Codigo_EPS= c.Codigo_EPS and e.Codigo_TER= d.Codigo_TER and f.Codigo_ADM =c.Codigo_ADM \r\n and g.Codigo_TER=f.Codigo_TER and h.Codigo_TID=g.Codigo_TID and i.Codigo_PLA= c.Codigo_PLA\r\n and c.Codigo_FAC like \'@PREFIJO-%\' and c.Fecha_FAC>=\'@FECHA_INICIAL 00:00:00\' and c.Fecha_FAC<=\'@FECHA_FINAL 23:59:59\' order by c.fecha_fac,c.codigo_fac;' WHERE  `Codigo_RPT`='facturasaludfecha' AND `Codigo_DCD`=0;
INSERT INTO `itmodulos` (`Codigo_MOD`, `Codigo_APP`, `Nombre_MOD`, `Descripcion_MOD`, `Icono_MOD`) VALUES ('8', '2', 'Tesoreria', 'Cuentas por Pagar, Caja, Bancos', 'credit');
INSERT INTO `ititems` (`Codigo_ITM`, `Codigo_MNU`, `Codigo_MOD`, `Codigo_APP`, `Nombre_ITM`) VALUES ('406', '46', '1', '2', 'Facturación');
INSERT INTO `ititems` (`Codigo_ITM`, `Codigo_MNU`, `Codigo_MOD`, `Codigo_APP`, `Nombre_ITM`, `Icono_ITM`, `Enlace_ITM`, `Padre_ITM`) VALUES ('407', '46', '1', '2', 'Facturado en un Periodo', 'finance.png', 'forms/nxsfactperiodo.php', '406');
INSERT INTO `ititems` (`Codigo_ITM`, `Codigo_MNU`, `Codigo_MOD`, `Codigo_APP`, `Nombre_ITM`, `Icono_ITM`, `Enlace_ITM`, `Padre_ITM`) VALUES ('408', '46', '1', '2', 'Comparativo Facturado', 'finance.png', 'forms/nxsfactmes.php', '406');
INSERT INTO `ititems` (`Codigo_ITM`, `Codigo_MNU`, `Codigo_MOD`, `Codigo_APP`, `Nombre_ITM`, `Icono_ITM`, `Enlace_ITM`, `Padre_ITM`) VALUES ('409', '46', '1', '2', 'Radicación', 'finance.png', '#', '0');
CREATE TABLE `cznotascontablesenc` (	`Codigo_NCT` INT NULL,	`Naturaleza_NCT` CHAR(50) NULL DEFAULT 'D',	`Descripcion_NCT` VARCHAR(250) NULL,	`Fecha_NCT` DATETIME NULL DEFAULT CURRENT_TIMESTAMP,	`TipoDoc_NCT` CHAR(2) NULL DEFAULT '01' COMMENT '01:Factura',	`NumeroDoc_CNT` CHAR(15) NULL COMMENT 'Numero de Factura',	`Codigo_TER` VARCHAR(10) NULL DEFAULT '0',	`Codigo_CNT` VARCHAR(5) NULL DEFAULT '001' COMMENT 'Concepto Nota',	`Codigo_CCT` VARCHAR(3) NULL DEFAULT '0' COMMENT 'Centro de Costo',	`Valor_NCT` DECIMAL(10,2) NULL DEFAULT '0',	`Codigo_USR` CHAR(4) NULL DEFAULT '0',	`Estado_NCT` CHAR(4) NULL DEFAULT '0') COMMENT='Notas Contables Débito y Crédito' COLLATE='latin1_swedish_ci' ENGINE=MyISAM;
INSERT INTO `itconsecutivos` (`Codigo_CNS`, `Tabla_CNS`, `Campo_CNS`, `Consecutivo_CNS`, `Descripcion_CNS`) VALUES ('31', 'cznotascontablesenc', 'Codigo_NCT', '0', 'Notas Contables Debito y Credito');
ALTER TABLE `cznotascontablesenc`	CHANGE COLUMN `Codigo_NCT` `Codigo_NCT` INT(11) NOT NULL ,	CHANGE COLUMN `Naturaleza_NCT` `Naturaleza_NCT` CHAR(1) NULL DEFAULT 'D' AFTER `Codigo_NCT`,	CHANGE COLUMN `Estado_NCT` `Estado_NCT` CHAR(4) NULL DEFAULT '1' AFTER `Codigo_USR`,	ADD PRIMARY KEY (`Codigo_NCT`),	ADD INDEX `Codigo_NCT` (`Codigo_NCT`),	ADD INDEX `Naturaleza_NCT` (`Naturaleza_NCT`),	ADD INDEX `Fecha_NCT` (`Fecha_NCT`),	ADD INDEX `TipoDoc_NCT` (`TipoDoc_NCT`),	ADD INDEX `NumeroDoc_CNT` (`NumeroDoc_CNT`),	ADD INDEX `Codigo_TER` (`Codigo_TER`),	ADD INDEX `Codigo_CNT` (`Codigo_CNT`),	ADD INDEX `Codigo_CCT` (`Codigo_CCT`),	ADD INDEX `Estado_NCT` (`Estado_NCT`);
ALTER TABLE `cznotascontablesenc`	COLLATE='utf8_general_ci',	ENGINE=InnoDB;
ALTER TABLE `cznotascontablesenc`	COLLATE='utf8_general_ci',	CHANGE COLUMN `Codigo_NCT` `Codigo_NCT` INT NOT NULL FIRST;
ALTER TABLE `cznotascontablesenc`	COLLATE='utf8_general_ci',	CONVERT TO CHARSET utf8;
UPDATE `itreports` SET `SQL_RPT`='Select a.Razonsocial_DCD, a.NIT_DCD, a.Direccion_DCD, a.Telefonos_DCD, a.EncabezadoFact_DCD, a.PiePaginaFact_DCD, \n b.ConsecIni_AFC, b.ConsecFin_AFC, b.Resolucion_AFC, b.Fecha_AFC, c.Codigo_FAC, c.Codigo_ADM, c.Fecha_FAC, c.ValPaciente_FAC, \n c.ValEntidad_FAC, c.ValDcto_FAC, c.Estado_FAC, CONCAT(e.ID_TER,\'-\',e.DigitoVerif_TER), e.Nombre_TER, e.Direccion_TER, e.Telefono_TER, \n LPAD(f.Codigo_ADM,10,\'0\'), CONCAT(h.Sigla_TID,\' \', g.ID_TER), g.Nombre_TER, i.Nombre_PLA, c.Codigo_EPS, c.Codigo_PLA, adddate(c.Fecha_FAC,d.VenceFactura_EPS), f.Autorizacion_ADM, a.Ciudad_DCD, g.Direccion_TER, g.Telefono_TER, Barrio_PAC, Nombre_MUN, x.Codigo_DGN, x.Descripcion_DGN, Prefijo_AFC, ValCredito_FAC  \nFrom itconfig a, czautfacturacion b, gxfacturas c, gxeps d, czterceros e, gxadmision f, czterceros g, cztipoid h, gxplanes i, gxpacientes p, czmunicipios m, gxdiagnostico x \nWhere x.Codigo_DGN=f.Codigo_DGN and m.Codigo_MUN=p.Codigo_MUN and m.Codigo_DEP=p.Codigo_DEP and c.Codigo_AFC = b.Codigo_AFC and \np.Codigo_TER=g.Codigo_TER and d.Codigo_EPS= c.Codigo_EPS and e.Codigo_TER= d.Codigo_TER and f.Codigo_ADM =c.Codigo_ADM \n and g.Codigo_TER=f.Codigo_TER and h.Codigo_TID=g.Codigo_TID and i.Codigo_PLA= c.Codigo_PLA\n and c.Codigo_FAC>=Concat(\'@PREFIJO\',\' \',LPAD(\'@CODIGO_INICIAL\',10,\'0\')) and c.Codigo_FAC<=Concat(\'@PREFIJO\',\' \',LPAD(\'@CODIGO_FINAL\',10,\'0\'));' WHERE  `Codigo_RPT`='facturasaluddet' AND `Codigo_DCD`=0;
ALTER TABLE `cznotascontablesenc`	CHANGE COLUMN `NumeroDoc_CNT` `NumeroDoc_NCT` CHAR(15) NULL DEFAULT NULL COMMENT 'Numero de Factura' AFTER `TipoDoc_NCT`;
UPDATE `itreports` SET `SQL_RPT`='select a.Codigo_ADM, f.Sigla_TID, c.ID_TER, b.Apellido1_PAC, b.Apellido2_PAC, b.Nombre1_PAC, b.Nombre2_PAC, b.Codigo_SEX, \r\nTIMESTAMPDIFF(YEAR, b.FechaNac_PAC, CURDATE()), b.FechaNac_PAC, d.Nombre_MUN, a.Autorizacion_ADM, c.Direccion_TER, c.Telefono_TER,\r\ndate(a.Fecha_ADM), g.Codigo_DGN, sum(i.Cantidad_ORD), j.Nombre_SER, a.Codigo_SDE, a.estado_adm\r\nFrom gxadmision a, gxpacientes b, czterceros c, czmunicipios d, czdepartamentos e, cztipoid f, gxdiagnostico g, gxordenescab h, gxordenesdet i, gxservicios j\r\nWhere a.Codigo_TER=b.Codigo_TER and b.Codigo_TER=c.Codigo_TER and d.Codigo_MUN=b.Codigo_MUN and d.Codigo_DEP=b.Codigo_DEP and h.Codigo_ORD=i.Codigo_ORD and h.Codigo_ADM=a.Codigo_ADM and h.Estado_ORD=\'1\' \r\nand j.Codigo_SER=i.Codigo_SER and e.Codigo_DEP=b.Codigo_DEP and f.Codigo_TID=c.Codigo_TID and g.Codigo_DGN=a.Codigo_DGN and a.Fecha_ADM>=\'@FECHA_INICIAL\' and a.Fecha_ADM<=\'@FECHA_FINAL 23:59:59\' and a.Codigo_EPS=\'@ENTIDAD\'\r\nGroup by f.Sigla_TID, c.ID_TER, b.Apellido1_PAC, b.Apellido2_PAC, b.Nombre1_PAC, b.Nombre2_PAC, b.Codigo_SEX, \r\nTIMESTAMPDIFF(YEAR, b.FechaNac_PAC, CURDATE()), b.FechaNac_PAC, d.Nombre_MUN, a.Autorizacion_ADM, c.Direccion_TER, c.Telefono_TER,\r\ndate(a.Fecha_ADM), g.Descripcion_DGN, j.Nombre_SER, a.Codigo_SDE, a.estado_adm\r\nOrder by 4, 5, 6' WHERE  `Codigo_RPT`='autorizaciones' AND `Codigo_DCD`=0;
ALTER TABLE `czautfacturacion`	CHANGE COLUMN `Prefijo_AFC` `Prefijo_AFC` VARCHAR(4) NULL DEFAULT '' AFTER `Codigo_AFC`;	
ALTER TABLE `gxpacientes`	CHANGE COLUMN `Nombre1_PAC` `Nombre1_PAC` VARCHAR(50) NULL DEFAULT '' AFTER `Codigo_TER`,	CHANGE COLUMN `Nombre2_PAC` `Nombre2_PAC` VARCHAR(50) NULL DEFAULT '' AFTER `Nombre1_PAC`,	CHANGE COLUMN `Apellido1_PAC` `Apellido1_PAC` VARCHAR(50) NULL DEFAULT '' AFTER `Nombre2_PAC`,	CHANGE COLUMN `Apellido2_PAC` `Apellido2_PAC` VARCHAR(50) NULL DEFAULT '' AFTER `Apellido1_PAC`;
INSERT INTO `ititems` (`Codigo_ITM`, `Codigo_MNU`, `Codigo_MOD`, `Codigo_APP`, `Nombre_ITM`, `Icono_ITM`, `Enlace_ITM`) VALUES ('410', '92', '6', '2', 'Epicrisis', '1.PatientData.png', 'forms/hcepicrisis.php');