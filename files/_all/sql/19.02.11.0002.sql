UPDATE `itconfig` SET `Version_DCD`='19.02.14.001';
ALTER TABLE `hcclasiftriage`	ADD COLUMN `Urgencia_HTR` CHAR(1) NULL DEFAULT '1' AFTER `Class_HTR`,	ADD INDEX `Urgencia_HTR` (`Urgencia_HTR`);
UPDATE `hcclasiftriage` SET `Urgencia_HTR`='0' WHERE  `Codigo_HTR`=4;
UPDATE `hcclasiftriage` SET `Urgencia_HTR`='0' WHERE  `Codigo_HTR`=5;
ALTER TABLE `hctriage`	CHANGE COLUMN `Codigo_CNS` `Codigo_CNS` CHAR(6) NULL DEFAULT NULL COMMENT 'Consultorio Triage' AFTER `Call_TRG`,	ADD COLUMN `Consultorio_TRG` CHAR(6) NULL DEFAULT NULL COMMENT 'Consultorio Urgencias' AFTER `Codigo_HTR`,	ADD INDEX `Consultorio_TRG` (`Consultorio_TRG`);
ALTER TABLE `hctriage`	CHANGE COLUMN `Fecha_TRG` `Fecha_TRG` DATETIME NOT NULL COMMENT 'Ingreso a Cola (Pretriage)' AFTER `Codigo_TER`,	ADD COLUMN `Fecha2_TRG` DATETIME NOT NULL COMMENT 'Llamado a Clasificación (Triage)' AFTER `Fecha_TRG`,	ADD COLUMN `Fecha3_TRG` DATETIME NOT NULL COMMENT 'Llamado a Atención (Urgencias)' AFTER `Fecha2_TRG`,	ADD INDEX `Fecha3_TRG` (`Fecha3_TRG`),	ADD INDEX `Fecha2_TRG` (`Fecha2_TRG`);
ALTER TABLE `gxconsultorios`	ADD COLUMN `Urgencias_CNS` ENUM('1','0') NULL DEFAULT '0' COMMENT 'Consultorio de Urgencias' AFTER `Triage_CNS`,	ADD INDEX `Urgencias_CNS` (`Urgencias_CNS`);
UPDATE `itreports` SET `SQL_RPT`='Select\r\n D.Codigo_FAC, DATE_FORMAT(D.Fecha_FAC, \'%d/%m/%Y\'),LPAD(A.Codigo_ADM,10,\'0\'), concat(Q.Sigla_TID,\' \',C.ID_TER), left(C.Nombre_TER, 60), \r\n J.Descripcion_ADM, E.Codigo_EPS, F.Nombre_TER, concat(\'{\',I.Codigo_USR,\'} \', I.ID_USR), D.ValPaciente_FAC, D.ValEntidad_FAC, K.Codigo_RAD,  DATE_FORMAT(L.FechaConf_RAD, \'%d/%m/%Y\'), D.ValCredito_FAC, D.ValTotal_FAC \r\nFrom\r\n czterceros AS C, gxeps AS E, czterceros AS F, cztipoid as Q, \r\n itusuarios AS I, gxtipoingreso AS J, gxadmision AS A, gxfacturas AS D \r\n left join czradicacionesdet AS K On D.Codigo_FAC=K.Codigo_FAC left join czradicacionescab AS L On L.Codigo_RAD=K.Codigo_RAD\r\nWhere\r\n A.Codigo_TER = C.Codigo_TER AND Q.Codigo_TID = C.Codigo_TID and D.Codigo_ADM=A.Codigo_ADM\r\n AND F.Codigo_TER = E.Codigo_TER AND trim(D.Codigo_EPS) = trim(E.Codigo_EPS) \r\n AND D.Codigo_USR = I.Codigo_USR AND J.Tipo_ADM = A.Ingreso_ADM and D.Estado_FAC=\'1\'\r\n AND D.Fecha_FAC>=\'@FECHA_INICIAL 00:00:00\' AND D.Fecha_FAC<=\'@FECHA_FINAL 23:59:59\'\r\nOrder By\r\nD.Fecha_FAC, D.Codigo_FAC\r\n \r\n Union\r\n \r\nSelect\r\n D.Codigo_FAC, DATE_FORMAT(D.Fecha_FAC, \'%d/%m/%Y\'),\'CAPITA\', \'0\', \'POBLACION CAPITADA\', \r\n \'FACTURA CAPITADA\', E.Codigo_EPS, F.Nombre_TER, concat(\'{\',I.Codigo_USR,\'} \', I.ID_USR), D.ValPaciente_FAC, D.ValEntidad_FAC, K.Codigo_RAD,  DATE_FORMAT(L.FechaConf_RAD, \'%d/%m/%Y\'), D.ValCredito_FAC, D.ValTotal_FAC \r\nFrom\r\n gxeps AS E, czterceros AS F, cztipoid as Q, \r\n itusuarios AS I, gxtipoingreso AS J, gxfacturascapita AS G, gxfacturas AS D \r\n left join czradicacionesdet AS K On D.Codigo_FAC=K.Codigo_FAC left join czradicacionescab AS L On L.Codigo_RAD=K.Codigo_RAD\r\nWhere\r\n D.Codigo_FAC=G.Codigo_FAC\r\n AND F.Codigo_TER = E.Codigo_TER AND trim(D.Codigo_EPS) = trim(E.Codigo_EPS) \r\n AND D.Codigo_USR = I.Codigo_USR and D.Estado_FAC=\'1\'\r\n AND D.Fecha_FAC>=\'@FECHA_INICIAL 00:00:00\' AND D.Fecha_FAC<=\'@FECHA_FINAL 23:59:59\'\r\nOrder By\r\nD.Fecha_FAC, D.Codigo_FAC;' WHERE  `Codigo_RPT`='listarfacturasfecha' AND `Codigo_DCD`=0;
INSERT INTO `ititems` (`Codigo_ITM`, `Codigo_MNU`, `Codigo_MOD`, `Codigo_APP`, `Nombre_ITM`, `Enlace_ITM`, `OptPrinter_ITM`, `OptNew_ITM`, `OptNo_ITM`) VALUES ('485', '93', '6', '2', 'Res. 256 Reg.Tipo 6', 'reports/res256t6.php', '1', '1', '1');
INSERT INTO `itreports` (`Codigo_RPT`, `Descripcion_RPT`) VALUES ('res256t6', 'Res 256 Tipo 6 Registro de detalle de Urgencias (TRIAGE II) ');
INSERT INTO `itreportsparam` (`Codigo_RPT`, `Campo_RPT`, `Titulo_RPT`, `Orden_RPT`, `Tipo_RPT`) VALUES ('res256t6', 'FECHA_FINAL', 'Fecha Final', '2', 'D');
INSERT INTO `itreportsparam` (`Codigo_RPT`, `Campo_RPT`, `Titulo_RPT`, `Orden_RPT`, `Tipo_RPT`) VALUES ('res256t6', 'FECHA_INICIAL', 'Fecha Inicial', '1', 'D');
UPDATE `itreports` SET `SQL_RPT`='SELECT \'6\', \'\', b.Sigla_TID, c.ID_TER, d.FechaNac_PAC, case d.Codigo_SEX when \'F\' then \'M\' ELSE \'H\' END, d.Apellido1_PAC, d.Apellido2_PAC, d.Nombre1_PAC, d.Nombre2_PAC, e.CodMin_EPS, DATE( a.Fecha2_TRG), DATE_FORMAT(a.Fecha2_TRG, "%H:%I" ), DATE(a.Fecha3_TRG), DATE_FORMAT(a.Fecha3_TRG, "%H:%I" ) \r\nFROM hctriage a, cztipoid b, czterceros c, gxpacientes d, gxeps e \r\nWHERE a.Codigo_TER=c.Codigo_TER AND c.Codigo_TID=b.Codigo_TID AND d.Codigo_TER=c.Codigo_TER AND e.Codigo_EPS=a.Codigo_EPS \r\nAND a.Fecha2_TRG >=\'@FECHA_INICIAL\' AND a.Fecha2_TRG<=\'@FECHA_FINAL\'' WHERE  `Codigo_RPT`='res256t6' AND `Codigo_DCD`=0;
UPDATE `itreports` SET `Orientacion_RPT`='L' WHERE  `Codigo_RPT`='res256t6' AND `Codigo_DCD`=0;
UPDATE `itreports` SET `SQL_RPT`='SELECT \'6\', \'\', b.Sigla_TID, c.ID_TER, d.FechaNac_PAC, case d.Codigo_SEX when \'F\' then \'M\' ELSE \'H\' END, d.Apellido1_PAC, d.Apellido2_PAC, d.Nombre1_PAC, d.Nombre2_PAC, e.CodMin_EPS, DATE( a.Fecha2_TRG), DATE_FORMAT(a.Fecha2_TRG, "%H:%I" ), DATE(a.Fecha3_TRG), DATE_FORMAT(a.Fecha3_TRG, "%H:%I" ) \r\nFROM hctriage a, cztipoid b, czterceros c, gxpacientes d, gxeps e \r\nWHERE a.Codigo_TER=c.Codigo_TER AND c.Codigo_TID=b.Codigo_TID AND d.Codigo_TER=c.Codigo_TER AND e.Codigo_EPS=a.Codigo_EPS AND a.Codigo_HTR=\'2\' \r\nAND a.Fecha2_TRG >=\'@FECHA_INICIAL\' AND a.Fecha2_TRG<=\'@FECHA_FINAL 23:59:59\'' WHERE  `Codigo_RPT`='res256t6' AND `Codigo_DCD`=0;
UPDATE `itreports` SET `SQL_RPT`='Select\r\n D.Codigo_FAC, DATE_FORMAT(D.Fecha_FAC, \'%d/%m/%Y\'),LPAD(A.Codigo_ADM,10,\'0\'), concat(Q.Sigla_TID,\' \',C.ID_TER), left(C.Nombre_TER, 60), \r\n J.Descripcion_ADM, E.Codigo_EPS, F.Nombre_TER, concat(\'{\',I.Codigo_USR,\'} \', I.ID_USR), D.ValPaciente_FAC, D.ValEntidad_FAC, K.Codigo_RAD,  DATE_FORMAT(L.FechaConf_RAD, \'%d/%m/%Y\'), D.ValCredito_FAC, D.ValTotal_FAC \r\nFrom\r\n czterceros AS C, gxeps AS E, czterceros AS F, cztipoid as Q, \r\n itusuarios AS I, gxtipoingreso AS J, gxadmision AS A, gxfacturas AS D \r\n left join czradicacionesdet AS K On D.Codigo_FAC=K.Codigo_FAC left join czradicacionescab AS L On L.Codigo_RAD=K.Codigo_RAD\r\nWhere\r\n A.Codigo_TER = C.Codigo_TER AND Q.Codigo_TID = C.Codigo_TID and D.Codigo_ADM=A.Codigo_ADM\r\n AND F.Codigo_TER = E.Codigo_TER AND trim(D.Codigo_EPS) = trim(E.Codigo_EPS) \r\n AND D.Codigo_USR = I.Codigo_USR AND J.Tipo_ADM = A.Ingreso_ADM and D.Estado_FAC=\'1\'\r\n AND D.Fecha_FAC>=\'@FECHA_INICIAL 00:00:00\' AND D.Fecha_FAC<=\'@FECHA_FINAL 23:59:59\'\r\n \r\n Union\r\n \r\nSelect\r\n D.Codigo_FAC, DATE_FORMAT(D.Fecha_FAC, \'%d/%m/%Y\'),\'CAPITA\', \'0\', \'POBLACION CAPITADA\', \r\n \'FACTURA CAPITADA\', E.Codigo_EPS, F.Nombre_TER, concat(\'{\',I.Codigo_USR,\'} \', I.ID_USR), D.ValPaciente_FAC, D.ValEntidad_FAC, K.Codigo_RAD,  DATE_FORMAT(L.FechaConf_RAD, \'%d/%m/%Y\'), D.ValCredito_FAC, D.ValTotal_FAC \r\nFrom\r\n gxeps AS E, czterceros AS F, cztipoid as Q, \r\n itusuarios AS I, gxtipoingreso AS J, gxfacturascapita AS G, gxfacturas AS D \r\n left join czradicacionesdet AS K On D.Codigo_FAC=K.Codigo_FAC left join czradicacionescab AS L On L.Codigo_RAD=K.Codigo_RAD\r\nWhere\r\n D.Codigo_ADM=G.Codigo_FAC\r\n AND F.Codigo_TER = E.Codigo_TER AND trim(D.Codigo_EPS) = trim(E.Codigo_EPS) \r\n AND D.Codigo_USR = I.Codigo_USR and D.Estado_FAC=\'1\'\r\n AND D.Fecha_FAC>=\'@FECHA_INICIAL 00:00:00\' AND D.Fecha_FAC<=\'@FECHA_FINAL 23:59:59\'\r\nOrder By\r\n2,1;' WHERE  `Codigo_RPT`='listarfacturasfecha' AND `Codigo_DCD`=0;
